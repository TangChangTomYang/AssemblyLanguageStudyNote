##åŠ¨æ€è°ƒè¯•

####ä¸€ã€ä»€ä¹ˆæ˜¯åŠ¨æ€è°ƒè¯•ï¼Ÿ
![](/assets/Snip20180605_5.png)
å½“æˆ‘ä»¬åœ¨Xcode ä¸­æ‰“ä¸€ä¸ªæ–­ç‚¹æ—¶ï¼ŒXcodeå…ˆå°†è¿™ä¸ªæ–­ç‚¹çš„ä¿¡æ¯å‘é€ç»™æ‰‹æœºä¸Šå®‰è£…çš„debugserver æœåŠ¡å™¨ï¼Œè¿™ä¸ªdebugserver æœåŠ¡å™¨å°†ä¿¡æ¯è½¬å‘ä¸ªAppï¼ŒApp åœ¨å°†ä¿¡æ¯åé¦ˆç»™debugserverï¼Œdebugserver å†å°†ä¿¡æ¯å‘é€ç»™Xcode ï¼Œè®©åæˆ‘ä»¬åœ¨Xcode ä¸Šé¢å°±èƒ½çœ‹è§è°ƒè¯•ä¿¡æ¯äº†ï¼Œè€…å°±æ˜¯åŠ¨æ€è°ƒè¯•çš„åŸç†ã€‚


####äºŒã€Xcode åŠ¨æ€è°ƒè¯•çš„åŸç†
- 1ã€ **å…³äºGCCã€LLVMã€LLDB**<br> Xcode çš„**ç¼–è¯‘å™¨**å‘å±•å†ç¨‹ï¼šGCC -> LLVM <br> Xcode çš„**è°ƒè¯•å™¨**å‘å±•å†ç¨‹ï¼šGDB -> LLDB
- 2ã€**debugserver ä¸€å¼€å§‹å­˜æ”¾åœ¨mac çš„Xcode é‡Œé¢**<br>/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/DeviceSupport/9.1/DeveloperDiskImage.dmg/usr/bion/debugserver
- 3ã€å½“Xcode è¯†åˆ«åˆ°æ‰‹æœºçš„è®¾å¤‡æ—¶ï¼ŒXcode ä¼šè‡ªåŠ¨å°†debugserverå®‰è£…åˆ°iPhone ä¸Šã€‚
- 4ã€Xcode è°ƒè¯•çš„å±€é™æ€§<br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªèƒ½è°ƒè¯•é€šè¿‡Xcodeå®‰è£…çš„App<br><br>![](/assets/Snip20180605_4.png)

####ä¸‰ã€åŠ¨æ€è°ƒè¯•ä»»æ„App
- 1ã€iPhoneä¸Šçš„debugserver åœ¨å“ªé‡Œå‘¢ï¼Ÿ
```
/Developer/usr/bin
```
**æ³¨æ„ï¼šè¿™ä¸ªè·¯åŠ²çš„æ–‡ä»¶å¯èƒ½ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨åˆ æ‰ï¼Œå¦‚æœæ²¡æ‰¾åˆ°ç”¨çœŸæœºè°ƒè¯•ä¸€ä¸‹å³å¯**

- 2ã€**debugserver æƒé™çš„é—®é¢˜**<br>(1)ã€é»˜è®¤æƒ…å†µä¸‹ï¼Œ/Developer/usr/bin ç›®å½•ä¸‹çš„debugserver æƒé™æ˜¯ä¸å¤Ÿçš„ï¼ˆå› ä¸ºè¿™ä¸ªdebugserver æ˜¯Xcode å¸®ç€å®‰è£…çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹åªèƒ½è°ƒè¯•Xcodeå®‰è£…çš„Appï¼Œåªæœ‰è¿™ä¸ªæƒé™ï¼Œåƒæ¥è‡ªApp store çš„App æ˜¯è°ƒè¯•ä¸äº†çš„ï¼‰ã€‚<br>(2)ã€/Developer è¿™ä¸ªæ–‡ä»¶å¤¹çš„æƒé™æ˜¯åªè¯»çš„ï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚<br>3ã€å¦‚æœéœ€è¦è°ƒè¯•å…¶ä»–çš„appï¼Œéœ€è¦å¯¹debugServeré‡æ–°ç­¾åæƒé™ï¼Œç­¾ä¸Š2ä¸ªè°ƒè¯•ç›¸å…³çš„æƒé™
```
get-task-allow
task_for_pid-allow
```

- 3ã€**å¦‚ä½•ç»™debugserverç­¾ä¸Šå…¨å‘**<br>iphoneä¸Šçš„ **/Developer**ç›®å½•æ˜¯åªè¯»çš„ï¼Œæ— æ³•ç›´æ¥å¯¹**/Developer/usr/bin/debugserver**æ–‡ä»¶ç­¾åï¼Œéœ€è¦å…ˆæŠŠdebugserverå¤åˆ¶åˆ°macä¸Šï¼Œåœ¨é€šè¿‡ldidç­¾åã€‚

    ```
    //1.å…ˆå°†æƒé™å¯¼å‡º
    $ ldid -e debugserver > debugserver.entitlements

    //2.debugserver.entitlementsæ–‡ä»¶ä¸­åœ¨æ·»åŠ 2æ¡æƒé™
        get-task-allow = YES
    task_for_pid-allow  = YES

    //3.åœ¨å°†æƒé™ç­¾å›å»å³å¯
    ldid -Sdebugserver.entitlements  debugserver

    //4. å°†æ–‡ä»¶è£…å›iphone å³å¯(è¿™æ˜¯ ä¸å¯èƒ½çš„äº‹ /Developer æ–‡ä»¶å¤¹æ˜¯åªè¯»çš„)
    ```
    
- 4ã€ æ³¨æ„ç›´æ¥å°†ç­¾åå›å»çš„debugserver ç›´æ¥æ‹–å›å»æ˜¯ä¸è¡Œçš„ã€‚æ˜¯ä¸èƒ½è¦†ç›– **/Developer/usr/bin** ç›®å½•çš„ã€‚é‚£æ€ä¹ˆåŠå‘¢ï¼Ÿ æ˜¯è¿™æ ·çš„ï¼Œåˆ°æ—¶æˆ‘ä»¬éœ€è¦åœ¨æ‰‹æœºç«¯å¯åŠ¨Debugserver è¿™ä¸ªæœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°† debugserver æ‹–åˆ° /usr/binç›®å½•ä¸‹äº†ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨æ‰‹æœºä¸Šé€šè¿‡ç»ˆç«¯æ¥å¯åŠ¨debugserveräº†ã€‚
debugserver å¸¸ç”¨æ³•ï¼š
```
Usage:
  debugserver host:port [program-name program-arg1 program-arg2 ...]
  debugserver /path/file [program-name program-arg1 program-arg2 ...]
  debugserver host:port --attach=<pid>
  debugserver /path/file --attach=<pid>
  debugserver host:port --attach=<process_name>
  debugserver /path/file --attach=<process_name>
  ```
æœ€å¸¸ç”¨çš„ä¸€ä¸ªæŒ‡ä»¤
  ```
  // è¡¨ç¤ºç›‘å¬10011ç«¯å£ï¼Œä»»ä½•ip éƒ½å¯ä»¥è¿æ¥è¿‡æ¥
  debugserver *:10011 -a WeChat       // -a æ˜¯attachment é™„åŠ çš„æ„æ€ 
```
  








####å››ã€å¸¸ç”¨çš„LLDB

- 1ã€**LLDB æŒ‡ä»¤æ ¼å¼**
```
<command> [<subcommand> [<subcommand> ...]] <action>  [-options  [option-value]] [argment [argment ...]]
```
**è¯´æ˜ï¼š**<br>(1)ã€å‡¡æ˜¯åœ¨æŒ‡ä»¤è¯´æ˜ä¹¦é‡Œé¢ çœ‹åˆ°çš„ `[]` è¡¨ç¤ºè¿™éƒ¨åˆ†æ˜¯å¯ä»¥çœç•¥çš„ã€‚ <br>(2)ã€ä¸€èˆ¬çš„æŒ‡ä»¤æ ¼å¼éƒ½æ˜¯ï¼š å‘½ä»¤ã€å­å‘½ä»¤ã€åŠ¨ä½œ(æ¯”å¦‚ï¼š å‘è®¾ç½®ä¸œè¥¿å‘¢ã€åˆ é™¤ä¸œè¥¿å‘¢ã€è¿˜æ˜¯æ·»åŠ ä¸œè¥¿ ç­‰)ã€é€‰é¡¹(æ¯”å¦‚ï¼š -nã€-dã€-i)ã€å‚æ•°ã€‚ 

- 2ã€**ç»™ testæ–¹æ³•è®¾ç½®æ–­ç‚¹ï¼š**
```
breakpoint set -n test
æˆ–è€…
breakpoint set --name test
```
**breakpoint æ˜¯ï¼š**`<command>`     <br> **setæ˜¯ï¼š**`<action>`        <br> **-næ˜¯ï¼š**`<options>`    <br>**testæ˜¯ï¼š**`<arguments>`  <br> <br> 

- 3ã€**hlep æŒ‡ä»¤çš„ç”¨æ³•ï¼š** **help** `<command>`  <br>å³: ç›´æ¥åœ¨å‘½ä»¤çš„å‰é¢åŠ  help æ¥æŸ¥çœ‹å‘½ä»¤å¸®åŠ©è¯´æ˜ï¼Œ<br>å¦‚ï¼š

  ``` 
  help breakpoint  // æŸ¥çœ‹breakpoint å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯

  help breakpoint set // æŸ¥çœ‹breakpoint set  å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯
  ä¾æ¬¡ç±»æ¨ï¼Œä¸€å±‚ä¸€å±‚çš„æŸ¥çœ‹å¸®åŠ©

  ```
  
- 4ã€**express å‘½ä»¤çš„ä½¿ç”¨ï¼š ** **express** `<cmd -options> - <expr>` <br>è¿™ä¸ªå‘½ä»¤å°± ğŸ‚ B äº†ï¼Œå¯ä»¥åœ¨è°ƒè¯•æ—¶åŠ¨æ€æ’å…¥æ‰§è¡Œä¸€ä¸ªè¡¨è¾¾å¼ ï¼ˆè°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œè®¾ç½®ä¸€ä¸ªå‚æ•° ç­‰ç­‰ï¼‰ <br><br> `<cmp-options>`å‘½ä»¤çš„é€‰é¡¹ <br> `-- ` å‘½ä»¤é€‰é¡¹ç»“æŸç¬¦ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„å‘½ä»¤é€‰é¡¹å·²ç»è®¾ç½®å®Œæ¯•ï¼Œå¦‚æœæ²¡æœ‰å‘½ä»¤é€‰é¡¹ï¼Œ `--` å¯ä»¥çœç•¥ <br> `<expr>` å°±æ˜¯éœ€è¦æ‰§è¡Œçš„è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ï¼š
```
// ä¸€æ—¦åœ¨LLDB ä¸­æ‰§è¡Œäº†è¿™å¥ä»£ç ï¼Œå°±ä¼šåœ¨çŸ­ç‚¹çš„ä¸‹ä¸€æ‰§è¡Œå‘½ä»¤å‰å…ˆæ‰§è¡Œ è¿™ä¸ªè¡¨è¾¾å¼
express self.view.backgroundColor = [UIColor redColor];
```
**express -o -- ** å’Œ æŒ‡ä»¤**po**çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚

- 5ã€**thread backtrace** <br> æ‰“å°çº¿ç¨‹çš„å †æ ˆä¿¡æ¯ã€‚<br> å¯ä»¥ç”¨ç®€å†™ï¼š**bt** ä»£æ›¿ï¼Œæ•ˆæœä¸€æ ·çš„ï¼Œéƒ½æ˜¯æ‰“å°å †æ ˆä¿¡æ¯ã€‚

- 6ã€**thread return [<expr>]**<br> è®©å‡½æ•°ç›´æ¥è¿”å›æŸä¸ªå€¼ï¼Œæ–­ç‚¹åé¢çš„ä»£ç ä¸ä¼šæ‰§è¡Œæ‰§è¡Œï¼Œç›´æ¥è·³è¿‡
```
thread return 10;
```

- 7ã€**thread variable [<variable-name>]**<br>æ‰“å°å½“å‰æ ˆå¸§çš„å˜é‡
```
thread variable // å°†ä¼šæ‰“å°å‡ºå½“å‰çš„æ‰€æœ‰çš„å±€éƒ¨å˜é‡çš„å€¼
åˆæˆ–è€…
thread variable a // æ‰“å°å‡ºå˜é‡a çš„å€¼
```

- 8ã€**thread continue** <br> è®©å½“å‰æ–­ç‚¹æ–­ä½çš„ç¨‹åºç»§ç»­æ‰§è¡Œ<br> ç®€å†™ **continue** æˆ–è€… **c**

- 9ã€**thread step-over**<br>å•æ­¥è¿è¡Œï¼ˆä¸€æ¬¡è¿è¡Œä¸€è¡Œä»£ç ï¼ŒæŠŠå­å‡½æ•°å½“æˆæ•´ä½“ä¸€æ­¥æ‰§è¡Œï¼‰<br> ç®€å†™ **next**æˆ–è€…**n**


- 10ã€**thread step-in**<br>å•æ­¥è¿è¡Œï¼ˆä¸€æ¬¡è¿è¡Œä¸€è¡Œä»£ç ï¼Œé‡åˆ°å­å‡½æ•°ä¼šè¿›å…¥å­å‡½æ•°ï¼‰<br>ç®€å†™ **step** æˆ–è€…**s**


- 11ã€**thread step-out**<br> æ‰§è¡Œå®Œå½“å‰å‡½æ•°çš„æ‰€æœ‰ä»£ç ï¼Œè¿”å›åˆ°è°ƒç”¨è¯¥ä»£ç å¤„<br>ç®€å†™**finish**

- 12ã€**thread step-inst-over** æŒ‡ä»¤çº§åˆ«å•æ­¥æ‰§è¡Œï¼ˆæ±‡ç¼–å‡½æ•°è°ƒç”¨å½“æˆä¸€æ­¥æ‰§è¡Œï¼‰<br>ç®€ç§° **nexti** æˆ–è€…**ni**

- 13ã€**thread step-inst** æŒ‡ä»¤çº§åˆ«å•æ­¥è¿è¡Œï¼ˆé‡åˆ°æ±‡ç¼–å‡½æ•°è°ƒç”¨ä¼šè·³è¿›æ±‡ç¼–å‡½æ•°ï¼‰<br>ç®€ç§°**stepi** æˆ–è€…**si**

- 14ã€ **ni**ã€**si** å’Œ **n**ã€**s** ç±»ä¼¼<br> **ni**ã€**si** æ˜¯æ±‡ç¼–æŒ‡ä»¤çº§åˆ«çš„<br> **n**ã€**s** æ˜¯æºç çº§åˆ«çš„ã€‚















































